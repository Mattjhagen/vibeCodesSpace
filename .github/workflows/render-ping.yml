# Ping Render service every 5 minutes to prevent free-tier sleep
name: Render keep-awake ping

on:
  schedule:
    # Every 5 minutes
    - cron: '*/5 * * * *'
  workflow_dispatch: # Allow manual run

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Render
        run: |
          url="${RENDER_PING_URL:-https://vibecodesspace.onrender.com/api}"
          echo "Pinging $url at $(date -u +%Y-%m-%dT%H:%M:%SZ)"
          curl -sf --max-time 30 "$url" -o /dev/null -w "HTTP %{http_code}\n" || true

    env:
      # Optional: set RENDER_PING_URL in Settings → Secrets and variables → Actions (Variables)
      # Default below: vibecodesspace.onrender.com (script.js BACKEND_URL base)
      RENDER_PING_URL: ${{ vars.RENDER_PING_URL }}
